<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Funcionário</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/dashboard.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="left_side_logo">
        <img src="./assets/img-nexus/logo_nexs.svg" alt="Logo Nexus." srcset="">
        <h2 class="left_side_title">Nexus.</h2>
    </div>
    <div class="container">
        <div class="left_side">
            <div class="profile_user">
                <div class="infos">
                    <div class="info_profile">
                        <h5 class="name_user">Sara</h5>
                        <h5 class="func_user">Atendente</h5>
                    </div>
                    <div class="icons_profile">
                        <a href="#"><i class="fa fa-user" aria-hidden="true"></i></a>
                        <a href="#"><i class="fa fa-cog" aria-hidden="true"></i></a>
                    </div>
                </div>
            </div>
            <div class="options">
                <div class="container_options">
                    <div class="initial item_option ">
                        <i class="fa fa-home" aria-hidden="true"></i>
                        <p class="text_initial">Página Inicial</p>
                    </div>
                </div>
                <div class="container_options">
                    <div class="dashboard item_option selected">
                        <i class="fa fa-line-chart" aria-hidden="true"></i>
                        <p class="text_initial">Dashboard</p>
                    </div>
                </div>
                <div class="container_options">
                    <div class="hist item_option ">
                        <i class="fa fa-calendar" aria-hidden="true"></i>
                        <p class="text_initial">Histórico</p>
                    </div>
                </div>
                <div class="container_options">
                    <div class="list_func item_option ">
                        <i class="fa fa-book" aria-hidden="true"></i>
                        <p class="text_initial">Lista Funcionários</p>
                    </div>
                </div>
                <div class="container_options ">
                    <div class="logout item_option ">
                        <i class="fa fa-sign-out" aria-hidden="true"></i>
                        <p class="text_initial">Sair</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="right_side2">
            <div class="f-part2">
                <h1 class="title-right2">MAIOR CONSUMO DOS COMPONENTES</h1>
                <div class="container-right2">
                    <div class="card">
                        <div class="top-card">
                            <h1 class="text-card">CPU</h1>
                            <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                        </div>
                        <div class="bottom-card">
                            <div class="left-bottom-card">
                                <h1 class="agencia-text">Agência</h1>
                                <p class="num-agencia">0000001</p>
                                <h1 class="maquina-text">Máquina</h1>
                                <p class="num-maquina">00-1</p>
                            </div>
                            <div class="chartBox">
                                <canvas id="myChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="top-card">
                            <h1 class="text-card">RAM</h1>
                            <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                        </div>
                        <div class="bottom-card">
                            <div class="left-bottom-card">
                                <h1 class="agencia-text">Agência</h1>
                                <p class="num-agencia">0000001</p>
                                <h1 class="maquina-text">Máquina</h1>
                                <p class="num-maquina">00-1</p>
                            </div>
                            <div class="chartBox">
                                <canvas id="myChart1"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="top-card">
                            <h1 class="text-card">DISCO</h1>
                            <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                        </div>
                        <div class="bottom-card">
                            <div class="left-bottom-card">
                                <h1 class="agencia-text">Agência</h1>
                                <p class="num-agencia">0000001</p>
                                <h1 class="maquina-text">Máquina</h1>
                                <p class="num-maquina">00-1</p>
                            </div>
                            <div class="chartBox">
                                <canvas id="myChart2"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grafico">
                    <div class="titulo">
                        <h2>Gráfico de Desempenho de Recursos da Máquina</h2>
                    </div>
                    <canvas id="myChart3"></canvas>
                </div>
            </div>
            <div class="container-side">
                <div class="container-s-part2">
                    <div class="chartBox2">
                        <h2>Agilidade da Maquina</h2>
                        <canvas id="gauge" style="margin-top: -50px;"></canvas>
                    </div>
                </div>
                <div class="s-part">
                    <div class="container-s-part3">
                        <h1 class="title-container-s-part2">Tarefas em Segundo Plano</h1>
                        <div class="container-alertas2">
                            <div class="alerta2">
                                <div class="t-alerta">
                                    <p class="i-maquina">Nome Tarefa</p>
                                    <div class="horario">
                                       <i class="fa fa-clock-o" aria-hidden="true"></i>
                                       <p class="horario_alerta">12:34</p>
                                    </div>
                                </div>
                                <div class="b-alerta alert-blue">
                                    <p class="elemento-alerta">CPU</p>
                                    <p class="porcentagem-alerta">20%</p>
                                </div>
                            </div>
                            <div class="alerta2">
                                <div class="t-alerta">
                                    <p class="i-maquina">Nome Tarefa</p>
                                    <div class="horario">
                                       <i class="fa fa-clock-o" aria-hidden="true"></i>
                                       <p class="horario_alerta">12:34</p>
                                    </div>
                                </div>
                                <div class="b-alerta alert-red">
                                    <p class="elemento-alerta">RAM</p>
                                    <p class="porcentagem-alerta">90%</p>
                                </div>
                            </div>
                            <div class="alerta2">
                                <div class="t-alerta">
                                    <p class="i-maquina">Nome Tarefa</p>
                                    <div class="horario">
                                       <i class="fa fa-clock-o" aria-hidden="true"></i>
                                       <p class="horario_alerta">12:34</p>
                                    </div>
                                </div>
                                <div class="b-alerta alert-yellow">
                                    <p class="elemento-alerta">DISCO</p>
                                    <p class="porcentagem-alerta">30%</p>
                                </div>
                            </div>
                        </div>
                        <div class="container-alertas">
                            <div class="alerta2">
                                <div class="t-alerta">
                                    <p class="i-maquina">Nome Tarefa</p>
                                    <div class="horario">
                                       <i class="fa fa-clock-o" aria-hidden="true"></i>
                                       <p class="horario_alerta">12:34</p>
                                    </div>
                                </div>
                                <div class="b-alerta alert-red">
                                    <p class="elemento-alerta">CPU</p>
                                    <p class="porcentagem-alerta">90%</p>
                                </div>
                            </div>
                            <div class="alerta2">
                                <div class="t-alerta">
                                    <p class="i-maquina">Nome Tarefa</p>
                                    <div class="horario">
                                       <i class="fa fa-clock-o" aria-hidden="true"></i>
                                       <p class="horario_alerta">12:34</p>
                                    </div>
                                </div>
                                <div class="b-alerta alert-red">
                                    <p class="elemento-alerta">RAM</p>
                                    <p class="porcentagem-alerta">90%</p>
                                </div>
                            </div>
                            <div class="alerta2">
                                <div class="t-alerta">
                                    <p class="i-maquina">Nome Tarefa</p>
                                    <div class="horario">
                                       <i class="fa fa-clock-o" aria-hidden="true"></i>
                                       <p class="horario_alerta">12:34</p>
                                    </div>
                                </div>
                                <div class="b-alerta alert-red">
                                    <p class="elemento-alerta">DISCO</p>
                                    <p class="porcentagem-alerta">90%</p>
                                </div>
                            </div>
                        </div>
                    </div>
                
            </div>

        </div>

    </div>
</body>

</html>

<script>

    let proximaAtualizacao;

    window.onload = plotarGrafico();

    function plotarGrafico() {

        const data = {
            labels: []
            ,
            datasets: [{
                label: 'Consumo geral de CPU',
                data: [80, 20],
                backgroundColor: [
                    'rgb(158, 106, 225)',
                    'rgb(241, 241, 244)'
                ],
                hoverOffset: 4
            }]
        };

        const doughnutLabel = {
            id: 'doughtnutLabel',
            beforeDatasetsDraw(chart, args, pluginOptions) {
                const { ctx, data } = chart;

                ctx.save();
                const xCoor = chart.getDatasetMeta(0).data[0].x;
                const yCoor = chart.getDatasetMeta(0).data[0].y;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle'
                ctx.font = 'bold 15px Poppins';
                ctx.fillStyle = 'rgb(241, 241, 244)';
                ctx.fillText(`${data.datasets[0].data[0]}%`, xCoor, yCoor);

            }
        }

        // Criando estrutura para plotar gráfico - config
        const config = {
            type: 'doughnut',
            data: data,
            options: {
                hoverBorderWidth: 0,
                borderWidth: 0,
                weight: 1,
                cutout: 37,
                events: ["mouseout", "click", "touchstart", "touchmove", "touchend"],
                showTooltips: false


            },
            plugins: [doughnutLabel]
        };

        const myChart = new Chart(
            document.getElementById('myChart'),
            config
        );

        const dataDoughnut1 = {
            labels: [],
            datasets: [{
                label: 'Consumo geral de CPU',
                data: [95, 5],
                backgroundColor: [
                    'rgb(158, 106, 225)',
                    'rgb(241, 241, 244)'
                ],
                hoverOffset: 4
            }]
        };

        const doughnutLabel1 = {
            id: 'doughnutLabel',
            beforeDatasetsDraw(chart, args, pluginOptions) {
                const { ctx } = chart;

                ctx.save();
                const xCoor1 = chart.getDatasetMeta(0).data[0].x;
                const yCoor1 = chart.getDatasetMeta(0).data[0].y;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle'
                ctx.font = 'bold 15px Poppins';
                ctx.fillStyle = 'rgb(241, 241, 244)';
                ctx.fillText(`${dataDoughnut1.datasets[0].data[0]}%`, xCoor1, yCoor1);
            }
        };

        // Criando estrutura para plotar gráfico - config
        const configDoughnut1 = {
            type: 'doughnut',
            data: dataDoughnut1,
            options: {
                hoverBorderWidth: 0,
                borderWidth: 0,
                weight: 1,
                cutout: 37,
                events: ["mouseout", "click", "touchstart", "touchmove", "touchend"],
                showTooltips: false
            },
            plugins: [doughnutLabel1]
        };

        const myChart1 = new Chart(
            document.getElementById('myChart1'),
            configDoughnut1
        );

        const dataDoughnut2 = {
            labels: [],
            datasets: [{
                label: 'Consumo geral de CPU',
                data: [45, 55],
                backgroundColor: [
                    'rgb(158, 106, 225)',
                    'rgb(241, 241, 244)'
                ],
                hoverOffset: 4
            }]
        };

        const doughnutLabel2 = {
            id: 'doughnutLabel',
            beforeDatasetsDraw(chart, args, pluginOptions) {
                const { ctx } = chart;

                ctx.save();
                const xCoor2 = chart.getDatasetMeta(0).data[0].x;
                const yCoor2 = chart.getDatasetMeta(0).data[0].y;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle'
                ctx.font = 'bold 15px Poppins';
                ctx.fillStyle = 'rgb(241, 241, 244)';
                ctx.fillText(`${dataDoughnut2.datasets[0].data[0]}%`, xCoor2, yCoor2);
            }
        };

        // Criando estrutura para plotar gráfico - config
        const configDoughnut2 = {
            type: 'doughnut',
            data: dataDoughnut2,
            options: {
                hoverBorderWidth: 0,
                borderWidth: 0,
                weight: 1,
                cutout: 37,
                events: ["mouseout", "click", "touchstart", "touchmove", "touchend"],
                showTooltips: false
            },
            plugins: [doughnutLabel2]
        };

        const myChart2 = new Chart(
            document.getElementById('myChart2'),
            configDoughnut2
        );

        const dataLine = {
            labels: ['Jan', 'Fev', 'Mar', 'Apr', 'Mai', 'Jun'],
            datasets: [{
                label: 'CPU',
                data: [300, 400, 300, 700, 500, 200,],
                backgroundColor: [
                    'rgb(22, 91, 170)'


                ],
                borderColor: [
                    'rgb(22, 91, 170)'
                ],
                hoverOffset: 4
            }, {
                label: 'RAM',
                data: [700, 600, 700, 750, 400, 500],
                backgroundColor: [
                    'rgb(247, 101, 163)'
                ],
                borderColor: [
                    'rgb(247, 101, 163)'
                ],
                hoverOffset: 4
            }, {
                label: 'DISCO',
                data: [600, 700, 600, 500, 400, 600],
                color: ['rgb(158, 106, 225)'],
                backgroundColor: [
                    'rgb(158, 106, 225)'
                ],
                borderColor: [
                    'rgb(158, 106, 225)'
                ],

                hoverOffset: 4
            }]
        };

        const LineLabel = {
            id: 'LineLabel',
            beforeDatasetsDraw(chart, args, pluginOptions) {
                const { ctx } = chart;

                ctx.save();
                const xCoor2 = chart.getDatasetMeta(0).data[0].x;
                const yCoor2 = chart.getDatasetMeta(0).data[0].y;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle'
                ctx.font = 'bold 15px Poppins';
                ctx.fillStyle = 'rgb(241, 241, 244)'
                // ctx.fillText(`${dataLine.datasets[0].data[0]}`, xCoor2, yCoor2);
            }

        };

        // Criando estrutura para plotar gráfico - config
        const configLine = {
            type: 'line',
            data: dataLine,
            options: {
                hoverBorderWidth: 0,
                borderWidth: 4,
                weight: 1,
                cutout: 37,
                events: ["mouseout", "click", "touchstart", "touchmove", "touchend"],
                showTooltips: false,
                scales: {
                    y: {
                        grid: {
                            color: 'rgba(236, 236, 236, 0.37)'
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(236, 236, 236, 0.37)'
                        }
                    }
                }
            },

            plugins: [LineLabel]
        };

        const myChart3 = new Chart(
            document.getElementById('myChart3'),
            configLine
        );
    }

    window.onload = teste();

    function teste() {


        // setup
        const data = {
            labels: ["Bom", "Ok", "Ruim"],
            datasets: [
                {
                    label: "Gauge",
                    data: [100, 65, 35],
                    backgroundColor: [
                        "rgba(255, 26, 104, 0.8)",
                        "rgba(255, 206, 86, 0.8)",
                        "rgba(75, 192, 192, 0.8)",
                    ],
                    needleValue: 70,
                    borderColor: "white",
                    borderWidth: 0,
                    cutout: "70%",
                    circumference: 180,
                    rotation: 270,
                    borderRadius: 1,

                },
            ],
        };



        //gaugeNeedle
        const gaugeNeedle = {
            id: "gaugeNeedle",
            afterDatasetDraw(chart, args, options) {
                const {
                    ctx,
                    config,
                    data,
                    chartArea: { top, right, bottom, left, width, height },
                } = chart;
                ctx.save();
                const needleValue = data.datasets[0].needleValue;
                const dataTotal = data.datasets[0].data.reduce((a, b) => a + b, 0);

                if (needleValue >= 0 && needleValue <= 100) {
                    var angle = Math.PI + (needleValue / 100) * Math.PI;
                } else {
                    var angle = 0;
                }

                const cx = width / 2;
                const cy = chart._metasets[0].data[0].y;

                //needle
                ctx.translate(cx, cy);
                ctx.rotate(angle);
                ctx.beginPath();
                ctx.moveTo(0, -10);
                ctx.lineTo(height - ctx.canvas.offsetTop + 15, 0); // change 160 value if the needle size gets changed
                ctx.lineTo(0, 10);
                ctx.fillStyle = "#444";
                ctx.fill();
                //needle dot -- bolinha do ponteiro
                ctx.translate(-cx, -cy);
                ctx.beginPath();
                ctx.arc(cx, cy, 10, 0, 10);
                ctx.fill();
                ctx.restore();

                //text
                ctx.font = "bold 30px Poppins";
                ctx.fillStyle = "white";
                ctx.fillText(needleValue + "%", cx, cy + 50);
                ctx.font = "bold 12px Poppins";
                ctx.fillText("Pessimo", 25, cy + 40);
                // ctx.fillText("OK", cx, 90);
                // ctx.fillText("Ruim", cx + 185, 200); // change values if the position gets changed
                ctx.fillText("Bom", cx + 130, 265); // change values if the position gets changed
                ctx.textAlign = "center";
                ctx.restore();
            },
        };
        // config
        const config = {
            type: "doughnut",
            data,
            options: {
                plugins: {
                    legend: {
                        display: false,
                    },
                    tooltip: {
                        yAlign: "bottom",
                        displayColors: false,
                        callbacks: {
                            label: function (tooltipItem, data, value) {
                                return tooltipItem.label;
                            },
                        },
                    },
                },
            },
            plugins: [gaugeNeedle],
        };

        const myChart4 = new Chart(
            document.getElementById('gauge'),
            config
        );
    }


</script>